package dbconnecton;import org.apache.logging.log4j.LogManager;import org.apache.logging.log4j.Logger;import org.jetbrains.annotations.NotNull;import java.sql.Connection;import java.sql.SQLException;@SuppressWarnings("WeakerAccess")public interface ReusableConnection extends ConnectionWrapper {    static final Logger LOG = LogManager.getLogger();    /**     * Returns connection queue this ReusableConnection resides in.     *     * @return Connection queue reference. If {@code null}, connections are terminated instead of returning to pool.     */    @NotNull DestructibleBlockingQueue<Connection> getConnectionQueue();    static ReusableConnection create(@NotNull Connection connection,                                     @NotNull DestructibleBlockingQueue<Connection> queue) {        try {            connection.setAutoCommit(true);        } catch (SQLException e) {            throw new RuntimeException("Cannot turn on autoCommit", e);        }        return new ReusableConnection() {            @Override            @NotNull            public DestructibleBlockingQueue<Connection> getConnectionQueue() {                return queue;            }            @Override            @NotNull            public Connection toSrc() {                return connection;            }        };    }    /**     * Returns connection to the pool if the queue exists, otherwise closes it     *     * @throws SQLException     */    @Override    default void close() throws SQLException {        if (toSrc().isClosed()) {            throw new SQLException("Attempting to close closed connection");        }        if (toSrc().isReadOnly())            toSrc().setReadOnly(false);        if (getConnectionQueue().isDestroyed()) {            LOG.debug("Connection {} terminating: pool closed", this);            toSrc().close();            return;        }        if (!getConnectionQueue().offer(this))            throw new SQLException("Error returning connection to the pool");        LOG.debug("Returning connection {} to the pool", this);    }}